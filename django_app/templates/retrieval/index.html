<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Search</title>
  <link rel="stylesheet" href="/static/retrieval/styles.css" />
</head>
<body data-effect="aurora">
  <div class="bg-grid"></div>
  <div class="bg-aurora"></div>
  <div class="bg-dots"></div>
  <canvas class="fx-canvas" id="fx-canvas"></canvas>
  <div class="page">
    <nav class="nav">
      <a class="logo" href="/">VisualSearch</a>
      <div class="nav-links">
        <a href="/search/">Search</a>
        <a href="/history/">History</a>
      </div>
      <div class="nav-auth">
        {% if user.is_authenticated %}
        <span class="user">{{ user.username }}</span>
        <a class="btn ghost" href="/logout/">Logout</a>
        {% else %}
        <a class="btn ghost" href="/login/">Login</a>
        <a class="btn" href="/register/">Register</a>
        {% endif %}
      </div>
    </nav>

    <header class="hero">
      <div class="badge">DINOv2 Retrieval</div>
      <h1>Upload an image, find its closest visual neighbors.</h1>
      <p>Search the local gallery using cosine similarity over precomputed features.</p>
    </header>

    <section class="panel">
      {% if error %}
      <div class="alert">{{ error }}</div>
      {% endif %}
      <form class="form" method="post" enctype="multipart/form-data" action="/search/">
        {% csrf_token %}
        <label class="dropzone" for="query_image">
          <input id="query_image" name="query_image" type="file" accept="image/*" required />
          <div class="drop-content">
            <div class="drop-title">Drop or browse</div>
            <div class="drop-subtitle">PNG, JPG, JPEG</div>
            <img id="preview" alt="preview" />
          </div>
        </label>

        <div class="controls">
          <label class="field">
            <span>Top K</span>
            <input name="top_k" type="number" min="1" max="100" value="{{ default_k }}" />
          </label>
          <button class="btn" type="submit">Search similar</button>
        </div>
      </form>
    </section>
  </div>

  <div class="fx-panel" id="fx-panel">
    <div class="fx-title">Background FX</div>
    <label class="fx-row">
      <span>Animation</span>
      <input id="fx-toggle" type="checkbox" checked />
    </label>
    <label class="fx-row">
      <span>Effect</span>
      <select id="fx-select">
        <option value="none">None</option>
        <option value="aurora">Aurora</option>
        <option value="grid">Grid</option>
        <option value="stars">Stars</option>
        <option value="particles">Particles</option>
        <option value="boids">Boids</option>
        <option value="sakura">Sakura</option>
      </select>
    </label>
  </div>
  <button class="fx-fab" id="fx-fab" type="button">FX</button>
  <script src="/static/retrieval/app.js"></script>
</body>
</html>
