<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Results</title>
  <link rel="stylesheet" href="/static/retrieval/styles.css" />
</head>
<body data-effect="aurora">
  <div class="bg-grid"></div>
  <div class="bg-aurora"></div>
  <div class="bg-dots"></div>
  <canvas class="fx-canvas" id="fx-canvas"></canvas>
  <div class="page">
    <nav class="nav">
      <a class="logo" href="/">VisualSearch</a>
      <div class="nav-links">
        <a href="/search/">Search</a>
        <a href="/history/">History</a>
      </div>
      <div class="nav-auth">
        {% if user.is_authenticated %}
        <span class="user">{{ user.username }}</span>
        <a class="btn ghost" href="/logout/">Logout</a>
        {% else %}
        <a class="btn ghost" href="/login/">Login</a>
        <a class="btn" href="/register/">Register</a>
        {% endif %}
      </div>
    </nav>

    <header class="hero compact">
      <div class="badge">Results</div>
      <h1>Top {{ top_k }} similar images</h1>
      <p>Closest matches from the feature bank.</p>
      <a class="link" href="/search/">New search</a>
      {% if user.is_authenticated and saved_to_history %}
      <div class="hint">Saved to your history.</div>
      {% elif not user.is_authenticated %}
      <div class="hint">Login to save history.</div>
      {% endif %}
    </header>

    <section class="panel">
      <div class="query-block">
        <div class="label">Query image</div>
        <img class="query-image" src="{{ query_url }}" alt="query" />
      </div>

      <div class="grid">
        {% for item in results %}
        <div class="card">
          {% if item.image_url %}
          <img src="{{ item.image_url }}" alt="result" />
          {% else %}
          <div class="placeholder">No image</div>
          {% endif %}
          <div class="card-meta">
            <div class="rank">#{{ item.rank }}</div>
            <div class="score">{{ item.similarity|floatformat:4 }}</div>
            {% if item.caption %}
            <div class="caption">{{ item.caption }}</div>
            {% endif %}
            {% if item.url %}
            <a class="source" href="{{ item.url }}" target="_blank" rel="noreferrer">Source</a>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </div>
    </section>
  </div>
  <div class="fx-panel" id="fx-panel">
    <div class="fx-title">Background FX</div>
    <label class="fx-row">
      <span>Animation</span>
      <input id="fx-toggle" type="checkbox" checked />
    </label>
    <label class="fx-row">
      <span>Effect</span>
      <select id="fx-select">
        <option value="none">None</option>
        <option value="aurora">Aurora</option>
        <option value="grid">Grid</option>
        <option value="stars">Stars</option>
        <option value="particles">Particles</option>
        <option value="boids">Boids</option>
        <option value="sakura">Sakura</option>
      </select>
    </label>
  </div>
  <button class="fx-fab" id="fx-fab" type="button">FX</button>
  <script src="/static/retrieval/app.js"></script>
</body>
</html>
